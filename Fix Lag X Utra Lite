--// FixLag X Pro Ultimate
-- Toggle menu: RightShift

local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")

-- GUI
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "FixLagXProUltimate"
ScreenGui.ResetOnSpawn = false

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 270, 0, 310)
Frame.Position = UDim2.new(0.5, -135, 0.5, -155)
Frame.BackgroundColor3 = Color3.fromRGB(25,25,25)
Frame.Active = true
Frame.Draggable = true
local UICorner = Instance.new("UICorner", Frame)
UICorner.CornerRadius = UDim.new(0, 12)

local Title = Instance.new("TextLabel", Frame)
Title.Size = UDim2.new(1,0,0,40)
Title.BackgroundTransparency = 1
Title.Text = "‚ö° FixLag X Pro Ultimate"
Title.TextColor3 = Color3.fromRGB(0,255,100)
Title.TextScaled = true

-- H√†m t·∫°o button
local function createButton(text, posY, callback)
    local btn = Instance.new("TextButton", Frame)
    btn.Size = UDim2.new(1, -20, 0, 40)
    btn.Position = UDim2.new(0, 10, 0, posY)
    btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.TextScaled = true
    btn.MouseButton1Click:Connect(callback)
    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(0, 8)
    return btn
end

-- Tr·∫°ng th√°i
local isOn = false

-- H√†m b·∫≠t FixLag
local function applyFixLag()
    if settings and settings().Rendering then
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
    end
    for _,v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") then
            v.Material = Enum.Material.Plastic
            v.Reflectance = 0
        elseif v:IsA("Decal") or v:IsA("Texture") then
            v.Transparency = 1
        end
    end
    Lighting.GlobalShadows = false
    Lighting.FogEnd = 9e9
    Lighting.Brightness = 1
    Lighting.ShadowSoftness = 0
    for _,v in pairs(Lighting:GetChildren()) do
        if v:IsA("PostEffect") then
            v.Enabled = false
        end
    end
    print("[FixLag X Pro] Optimization applied!")
end

-- H√†m kh√¥i ph·ª•c
local function restore()
    if settings and settings().Rendering then
        settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
    end
    Lighting.GlobalShadows = true
    for _,v in pairs(Lighting:GetChildren()) do
        if v:IsA("PostEffect") then
            v.Enabled = true
        end
    end
    print("[FixLag X Pro] Restored default settings!")
end

-- Toggle Fix Lag
local ToggleBtn = createButton("üöÄ B·∫≠t Fix Lag", 50, function()
    isOn = not isOn
    if isOn then
        applyFixLag()
        ToggleBtn.Text = "‚ùå T·∫Øt Fix Lag"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(0,120,0)
    else
        restore()
        ToggleBtn.Text = "üöÄ B·∫≠t Fix Lag"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
    end
end)

-- FPS Cap 30
createButton("üéØ FPS Cap 30", 100, function()
    if setfpscap then setfpscap(30) end
    print("[FixLag X Pro] FPS capped at 30")
end)

-- FPS Cap 60
createButton("üéØ FPS Cap 60", 150, function()
    if setfpscap then setfpscap(60) end
    print("[FixLag X Pro] FPS capped at 60")
end)

-- FPS Cap 120
createButton("üéØ FPS Cap 120", 200, function()
    if setfpscap then setfpscap(120) end
    print("[FixLag X Pro] FPS capped at 120")
end)

-- FPS Unlock
createButton("üöÄ Unlock FPS (Max)", 250, function()
    if setfpscap then setfpscap(9999) end
    print("[FixLag X Pro] FPS unlocked (max)")
end)

-- Toggle menu b·∫±ng RightShift
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.RightShift then
        Frame.Visible = not Frame.Visible
    end
end)

print("[FixLag X Pro Ultimate] Loaded successfully!")